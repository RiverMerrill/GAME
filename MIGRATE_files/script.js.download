
var data;
// db.ref('/companies/').once('value').then(function (snapshot) {
//     data = snapshot.val()
//     var storage = firebase.storage();
//     for(company in data){
//         var storageRef = storage.ref('images/' + data[company].title + '.jpeg')
//         setTimeout(storageRef.putString(data[company].image.substring(data[company].image.indexOf(',') + 1), 'base64').then(function (snapshot) {
//             storageRef.getDownloadURL().then(function (url) {
//                 firebase.database().ref('companies1/' + company).set({
//                     category: data[company].category,
//                     description: data[company].description,
//                     image: url,
//                     title: data[company].title
//                 })
//             })
//         }), 3000);
//     }
// });


var storage = firebase.storage();
var storageRef = storage.ref();
var db = firebase.database()
var i = 0;
var arr = [];
db.ref('companies1').once('value').then(function (snapshot) {
    console.log('data loaded');
    data = snapshot.val();
    for (company in data) {
        var comp = company;
        var title = data[company].title;
        arr.push({title: title});
        storageRef.child('images/' + title + '.jpeg').getDownloadURL().then(function (url) {
            arr[i].image = ({ image: url });
            i++
        })
        break;
}
    // for (company in data) {
    //     arr[i].title = data[company].title;
    //     console.log(data[company].title);
    //     i++
    // }
    console.log(arr);

})
            // db.ref('companies1/' + company).update({
            //     image: url
            // })